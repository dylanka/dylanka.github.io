<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Game Title</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
<!-- 	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/style.css"> -->

</head>

<body>
	<h1>Game Title</h1>
	<div id="gameFrame">

		<script type="text/javascript">

		var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });

        var mainState;

		var background;
		var player;
		var cursors;
        var bullets;
        var bulletTime = 0;
        var fire;

        var enemies;

        var score = 0;
        var scoreText;
        var winText;

    	function preload() {

    		game.load.image('background', 'assets/background.png');
    		game.load.image('player', 'assets/ship.png');
            game.load.image('bullet', 'assets/bullet.png');
            game.load.image('enemy', 'assets/enemy.png');

    	}

    	function create() {

		    game.add.sprite(0, 0, 'background');

		    background = game.add.tileSprite(0, 0, 800, 800, 'background');

	        player = game.add.sprite(100, game.world.height - 300, 'player');

	        game.physics.enable(player, Phaser.Physics.ARCADE);

            // game.physics.ARCADE.overlap(bullet,enemy,collisionHandler,null,this);

	        cursors = game.input.keyboard.createCursorKeys();

            bullets = game.add.group();
            bullets.enableBody = true;
            bullets.physicsBodyType = Phaser.Physics.ARCADE;
            bullets.createMultiple(30, 'bullet');
            bullets.setAll('anchor.x', 1);
            bullets.setAll('anchor.y', 0.5);
            bullets.setAll('outOfBoundsKill', true);
            bullets.setAll('checkWorldBounds', true);

            fireButton = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);

            enemies = game.add.group();
            enemies.enableBody = true;
            enemies.physicsBodyType = Phaser.Physics.ARCADE;

            createEnemies();

        function createEnemies(){
            for(var x = 0; x < 2; x++){
                for(var y = 0; y < 5; y++){
                    var enemy = enemies.create(x*70,y*75,'enemy');
                    enemy.anchor.setTo(0.5,0.5);
                }
            }

            enemies.y = 100;
            enemies.x = 650;

            var tween = game.add.tween(enemies).to({x:-150}, 5000, Phaser.Easing.Linear.None, true, 50, 0, false);

            tween.onLoop.add(attack,this);

        }

        function attack(){
            enemies.x += 8;
        }            

            // scoreText = game.add.text(0,550,'Score:'(font: '32px Arial',fill: #fff));
            // winText = game.add.text(game.world.centerX,game.world.centerY,'You Win!'(font: '32px Arial',fill: #fff));
            // winText.visible = false;

    	}

        function update() {

        	player.body.velocity.x = 0;

        	player.body.velocity.y = 0;

	        background.tilePosition.x -= 1;

        	if(cursors.left.isDown){
        		player.body.velocity.x = -180;
        	}
        	if(cursors.right.isDown){
        		player.body.velocity.x = 180;
        	}
        	if(cursors.up.isDown){
        		player.body.velocity.y = -180;
        	}
        	if(cursors.down.isDown){
        		player.body.velocity.y = 180;
        	}

            if(fireButton.isDown){
                fireBullet();
            }

            // scoreText.text = 'Score' + score;

            // if(score == 1200){
            //     winText.visible = true;
            //     scoreText.visible = false;
            // }

        }

        function fireBullet(){
            if(game.time.now > bulletTime)
                bullet = bullets.getFirstExists(false);
                    if(bullet){
                        bullet.reset(player.x + 25,player.y + 10);
                        bullet.body.velocity.x = 500;
                        bulletTime = game.time.now + 10;
                    }
        }


        // function collisionHandler(bullet,enemy){
        //     bullet.kill();
        //     enemy.kill();
        //     score += 100;
        // }

        function render(){

        }

        game.state.add('mainState',mainState);
        game.state.start('mainState');

		</script>
	</div>
</body>
</html>